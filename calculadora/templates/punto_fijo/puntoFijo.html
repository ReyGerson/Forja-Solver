<!-- metodo/templates/metodo/punto_fijo.html -->

<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <title>Método de Punto Fijo</title>
    <style>
        table,
        th,
        td {
            border: 1px solid black;
            border-collapse: collapse;
            padding: 5px;
        }
    </style>
</head>

<body>
    <h1>Método de Punto Fijo</h1>

    <form method="post">
        {% csrf_token %}
        {{ form.as_p }}
        <button type="submit">Calcular</button>
    </form>


    {% if resultado %}
    <h2>Resultados</h2>
    <p><strong>Función:</strong> F(x) = {{ fx }}</p>
    <p><strong>Despeje:</strong> x = {{ gx }}</p>
    <p><strong>Fórmula de error:</strong> εₐ = |(xₙ₊₁ - xₙ) / xₙ₊₁| × 100%</p>

    <h3>Iteraciones paso a paso:</h3>
    <ul>
        <li><strong>Valor inicial:</strong> {{ form.cleaned_data.valor_inicial }}</li>
        {% for r in resultado %}
        <li>Iteración {{ r.iteracion }}: {{ r.detalle }}<br>{{ r.error_detalle }}</li>
        {% endfor %}
    </ul>

    <h3>Tabla final</h3>
    <table>
        <thead>
            <tr>
                <th>Iteración</th>
                <th>Xi</th>
                <th>Error %</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>v.i</td>
                <td>{{ form.cleaned_data.valor_inicial }}</td>
                <td>-</td>
            </tr>
            {% for r in resultado %}
            <tr>
                <td>{{ r.iteracion }}</td>
                <td>{{ r.x }}</td>
                <td>{{ r.error }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

    <p><strong>Solución aproximada:</strong> x = {{ solucion }}</p>
    <p><strong>Comprobación:</strong> F({{ solucion }}) = {{ comprobacion }}</p>
    {% endif %}

    <p><a href="{% url 'historialPuntoFijo' %}">Ver historial de ejecuciones anteriores</a></p>

</body>

</html>